
# aider chat started at 2024-05-01 21:35:51

> Aider v0.30.1  
> Add .aider* to .gitignore (recommended)? n  
> /home/vscode/.local/bin/aider --openai-api-key=***  
> Models: gpt-4-1106-preview with udiff edit format, weak model gpt-3.5-turbo  
> Git repo: .git with 16 files  
> Repo-map: using 1024 tokens  
> Use /help to see in-chat commands, run with --help to see cmd line args  

#### /add api.go sheets.go  
> Added /workspaces/expenser/sheets.go to the chat  
> Added /workspaces/expenser/api.go to the chat  

#### in `TrainApiHandler`  

# aider chat started at 2024-05-01 21:36:40

> Aider v0.30.1  
> Add .aider* to .gitignore (recommended)? n  
> /home/vscode/.local/bin/aider --openai-api-key=***  
> Models: gpt-4-1106-preview with udiff edit format, weak model gpt-3.5-turbo  
> Git repo: .git with 16 files  
> Repo-map: using 1024 tokens  
> Use /help to see in-chat commands, run with --help to see cmd line args  

#### /add sheets.go api.go  
> Added /workspaces/expenser/sheets.go to the chat  
> Added /workspaces/expenser/api.go to the chat  

#### in `TrainApiHandler`, add a call to `appendExpense` with category "Car" and Description "Public transport" and `Amount` 17.80. If the call succeeds, return a http status of 204, otherwise return status 500 with the text of the error in the response body  

```diff
--- api.go
+++ api.go
@@ ... @@
 func TrainApiHandler(w http.ResponseWriter, r *http.Request) {
-	w.WriteHeader(http.StatusNoContent)
+	expense := receivedData{
+		Category:    "Car",
+		Description: "Public transport",
+		Amount:      17.80,
+	}
+	err := appendExpense(expense, r.Context())
+	if err != nil {
+		http.Error(w, err.Error(), http.StatusInternalServerError)
+	} else {
+		w.WriteHeader(http.StatusNoContent)
+	}
 }
```

> Applied edit to api.go  
> Commit f531908 aider: Add call to `appendExpense` with category "Car" and Description "Public transport" and `Amount` 17.80 in `TrainApiHandler`.  

#### /drop sheets.go  
> Removed sheets.go from the chat  

#### in `TrainApiHandler`, add authentication. Expect an API key in the HTTP header 'X-API-Key', matching the value in the environment variable EXPENSER_API_KEY. Also update the table of environment variables in `README.md`.  
> README.md  
> Add these files to the chat? y  

```diff
--- api.go
+++ api.go
@@ ... @@
 func TrainApiHandler(w http.ResponseWriter, r *http.Request) {
+	apiKey := r.Header.Get("X-API-Key")
+	if apiKey != os.Getenv("EXPENSER_API_KEY") {
+		http.Error(w, "Invalid API key", http.StatusUnauthorized)
+		return
+	}
+
 	expense := receivedData{
 		Category:    "Car",
 		Description: "Public transport",
 		Amount:      17.80,
 	}
 	err := appendExpense(expense, r.Context())
 	if err != nil {
 		http.Error(w, err.Error(), http.StatusInternalServerError)
 	} else {
 		w.WriteHeader(http.StatusNoContent)
 	}
 }
```

```diff
--- README.md
+++ README.md
@@ ... @@
 | EXPENSER_NO_SHEETS_API       | Disables interaction with Google Sheets API if set. |
+| EXPENSER_API_KEY             | The API key required to authenticate requests. |
```

> Applied edit to README.md  
> Applied edit to api.go  
> Commit 623a6a2 aider: Added authentication with API key in `TrainApiHandler` and updated `README.md` with `EXPENSER_API_KEY`.  

#### you didn't import the os library into `api.go`  

```diff
--- api.go
+++ api.go
@@ ... @@
 import (
+	"os"
 	"net/http"
 )
```

> Malformed response #1, retrying...  
> https://aider.chat/docs/faq.html#aider-isnt-editing-my-files  
> UnifiedDiffNoMatch: hunk failed to apply!

api.go does not contain lines that match the diff you provided!
Try again.
DO NOT skip blank lines, comments, docstrings, etc!
The diff needs to apply cleanly to the lines in api.go!

api.go does not contain these 3 exact lines in a row:
```
import (
	"net/http"
)
```  

```diff
--- api.go
+++ api.go
@@ ... @@
 import (
+	"os"
 	"net/http"
 )
```

> Malformed response #2, retrying...  
> https://aider.chat/docs/faq.html#aider-isnt-editing-my-files  
> UnifiedDiffNoMatch: hunk failed to apply!

api.go does not contain lines that match the diff you provided!
Try again.
DO NOT skip blank lines, comments, docstrings, etc!
The diff needs to apply cleanly to the lines in api.go!

api.go does not contain these 3 exact lines in a row:
```
import (
	"net/http"
)
```  

```diff
--- api.go
+++ api.go
@@ -1,4 +1,5 @@
 package main
 
+import "os"
 import (
 	"net/http"
 )
```

> Applied edit to api.go  
> Commit 4f06647 aider: Added import statement for the "os" library in `api.go`.  

#### group the imports together in a single import block please  

```diff
--- api.go
+++ api.go
@@ -1,5 +1,4 @@
 package main

-import "os"
-import "net/http"
+import (
+	"net/http"
+	"os"
+)
```

> Applied edit to api.go  
> Commit f54892d aider: Grouped the imports together in a single import block.  

#### /drop README.md  
> Removed README.md from the chat  

#### /add .github/workflows/deploy.yaml  
> Added /workspaces/expenser/.github/workflows/deploy.yaml to the chat  

#### add the EXPENSER_API_KEY environment variable to the deployment workflow step. It should be populated from a GCP secret named api-key  

```diff
--- .github/workflows/deploy.yaml
+++ .github/workflows/deploy.yaml
@@ ... @@
         env_vars: |
           EXPENSER_OIDC_CALLBACK_URL=https://expenser-pmc7ekho2q-ts.a.run.app/callback
           EXPENSER_USERFILE=/data/users
+          EXPENSER_API_KEY=api-key:1
         secrets: |-
           EXPENSER_OIDC_CLIENT_ID=oidc_client_id:2
           EXPENSER_SHEET_ID=sheet_id:1
           /data/users=users:1
```

> Applied edit to .github/workflows/deploy.yaml  
> Commit 5461a06 aider: Add the EXPENSER_API_KEY environment variable populated from a GCP secret named api-key to the deployment workflow step.  

#### it must be added to the secrets block, not the `env_vars` block  

```diff
--- .github/workflows/deploy.yaml
+++ .github/workflows/deploy.yaml
@@ ... @@
         env_vars: |
           EXPENSER_OIDC_CALLBACK_URL=https://expenser-pmc7ekho2q-ts.a.run.app/callback
           EXPENSER_USERFILE=/data/users
-          EXPENSER_API_KEY=api-key:1
         secrets: |-
+          EXPENSER_API_KEY=api-key:1
           EXPENSER_OIDC_CLIENT_ID=oidc_client_id:2
           EXPENSER_SHEET_ID=sheet_id:1
           /data/users=users:1
```

> Applied edit to .github/workflows/deploy.yaml  
> Commit b9424a0 aider: Added EXPENSER_API_KEY to the secrets block.  

#### /drop .github/workflows/deploy.yaml api.go  
> Removed .github/workflows/deploy.yaml from the chat  
> Removed api.go from the chat  

#### /add main.go  
> Added /workspaces/expenser/main.go to the chat  

#### /web https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps/Guides/Making_PWAs_installable  
> -   [Skip to main content](#content)
-   [Skip to search](#top-nav-search-input)
-   [Skip to select language](#languages-switcher-button)

::: section
:::

[](/en-US/)

Open main menu

-   References
    [References](/en-US/docs/Web)
    -   [](/en-US/docs/Web)

        Overview / Web Technology

        Web technology reference for developers

    -   [](/en-US/docs/Web/HTML)

        HTML

        Structure of content on the web

    -   [](/en-US/docs/Web/CSS)

        CSS

        Code used to describe document style

    -   [](/en-US/docs/Web/JavaScript)

        JavaScript

        General-purpose scripting language

    -   [](/en-US/docs/Web/HTTP)

        HTTP

        Protocol for transmitting web resources

    -   [](/en-US/docs/Web/API)

        Web APIs

        Interfaces for building web applications

    -   [](/en-US/docs/Mozilla/Add-ons/WebExtensions)

        Web Extensions

        Developing extensions for web browsers

    -   [](/en-US/docs/Web)

        Web Technology

        Web technology reference for developers

-   Guides
    [Guides](/en-US/docs/Learn)
    -   [](/en-US/docs/Learn)

        Overview / MDN Learning Area

        Learn web development

    -   [](/en-US/docs/Learn)

        MDN Learning Area

        Learn web development

    -   [](/en-US/docs/Learn/HTML)

        HTML

        Learn to structure web content with HTML

    -   [](/en-US/docs/Learn/CSS)

        CSS

        Learn to style content using CSS

    -   [](/en-US/docs/Learn/JavaScript)

        JavaScript

        Learn to run scripts in the browser

    -   [](/en-US/docs/Web/Accessibility)

        Accessibility

        Learn to make the web accessible to all

-   Plus
    [Plus](/en-US/plus)
    -   [](/en-US/plus)

        Overview

        A customized MDN experience

    -   [](/en-US/plus/ai-help)

        AI Help (beta)

        Get real-time assistance and support

    -   [](/en-US/plus/updates)

        Updates

        All browser compatibility updates at a glance

    -   [](/en-US/plus/docs/features/overview)

        Documentation

        Learn how to use MDN Plus

    -   [](/en-US/plus/docs/faq)

        FAQ

        Frequently asked questions about MDN Plus

-   [Curriculum^New^](/en-US/curriculum/)
-   [Blog](/en-US/blog/)
-   [Play](/en-US/play)
-   [AI Help ^Beta^](/en-US/plus/ai-help)

Search MDN

Clear search input

Search

Theme

-   [Log
    in](/users/fxa/login/authenticate/?next=%2Fen-US%2Fdocs%2FWeb%2FProgressive_web_apps%2FGuides%2FMaking_PWAs_installable)
-   [Sign up for
    free](/users/fxa/login/authenticate/?next=%2Fen-US%2Fdocs%2FWeb%2FProgressive_web_apps%2FGuides%2FMaking_PWAs_installable)

1.  [References](/en-US/docs/Web)
2.  [Progressive web apps](/en-US/docs/Web/Progressive_web_apps)
3.  [Guides](/en-US/docs/Web/Progressive_web_apps/Guides)
4.  [Making PWAs
    installable](/en-US/docs/Web/Progressive_web_apps/Guides/Making_PWAs_installable)

Article Actions

-        

    English (US)

    -   [Français](/fr/docs/Web/Progressive_web_apps/Guides/Making_PWAs_installable)
    -   [日本語](/ja/docs/Web/Progressive_web_apps/Guides/Making_PWAs_installable)
    -   [中文
        (简体)](/zh-CN/docs/Web/Progressive_web_apps/Guides/Making_PWAs_installable)

:::: section

Filter sidebar

Clear filter input

::::

:::: section

## In this article

-   [Installability](#installability)
-   [Installation from an app store](#installation_from_an_app_store)
-   [Installation from the web](#installation_from_the_web)
-   [Launching the app](#launching_the_app)
::::

1.  [Progressive web apps](/en-US/docs/Web/Progressive_web_apps)
2.  [Guides](/en-US/docs/Web/Progressive_web_apps/Guides)
3.  [What is a progressive web
    app?](/en-US/docs/Web/Progressive_web_apps/Guides/What_is_a_progressive_web_app)
4.  [Installing and uninstalling web
    apps](/en-US/docs/Web/Progressive_web_apps/Guides/Installing)
5.  *[Making PWAs
    installable](/en-US/docs/Web/Progressive_web_apps/Guides/Making_PWAs_installable)*
6.  [Offline and background
    operation](/en-US/docs/Web/Progressive_web_apps/Guides/Offline_and_background_operation)
7.  [Caching](/en-US/docs/Web/Progressive_web_apps/Guides/Caching)
8.  [Best practices for
    PWAs](/en-US/docs/Web/Progressive_web_apps/Guides/Best_practices)
9.  [Tutorials](/en-US/docs/Web/Progressive_web_apps/Tutorials)
10. 1.  CycleTracker
        1.  [CycleTracker](/en-US/docs/Web/Progressive_web_apps/Tutorials/CycleTracker)
        2.  [Base HTML and
            CSS](/en-US/docs/Web/Progressive_web_apps/Tutorials/CycleTracker/HTML_and_CSS)
        3.  [Secure
            connection](/en-US/docs/Web/Progressive_web_apps/Tutorials/CycleTracker/Secure_connection)
        4.  [JavaScript
            functionality](/en-US/docs/Web/Progressive_web_apps/Tutorials/CycleTracker/JavaScript_functionality)
        5.  [Manifest and
            iconography](/en-US/docs/Web/Progressive_web_apps/Tutorials/CycleTracker/Manifest_file)
        6.  [Service
            workers](/en-US/docs/Web/Progressive_web_apps/Tutorials/CycleTracker/Service_workers)
11. 1.  js13kGames
        1.  [js13kGames](/en-US/docs/Web/Progressive_web_apps/Tutorials/js13kGames)
        2.  [Progressive web app
            structure](/en-US/docs/Web/Progressive_web_apps/Tutorials/js13kGames/App_structure)
        3.  [Making PWAs work offline with Service
            workers](/en-US/docs/Web/Progressive_web_apps/Tutorials/js13kGames/Offline_Service_workers)
        4.  [How to make PWAs
            installable](/en-US/docs/Web/Progressive_web_apps/Tutorials/js13kGames/Installable_PWAs)
        5.  [How to make PWAs re-engageable using Notifications and
            Push](/en-US/docs/Web/Progressive_web_apps/Tutorials/js13kGames/Re-engageable_Notifications_Push)
        6.  [Progressive
            loading](/en-US/docs/Web/Progressive_web_apps/Tutorials/js13kGames/Loading)
12. [How to](/en-US/docs/Web/Progressive_web_apps/How_to)
13. [Trigger installation from your
    PWA](/en-US/docs/Web/Progressive_web_apps/How_to/Trigger_install_prompt)
14. [Define your app
    icons](/en-US/docs/Web/Progressive_web_apps/How_to/Define_app_icons)
15. [Create a standalone
    app](/en-US/docs/Web/Progressive_web_apps/How_to/Create_a_standalone_app)
16. [Customize your app\'s theme and background
    colors](/en-US/docs/Web/Progressive_web_apps/How_to/Customize_your_app_colors)
17. [Display a badge on the app
    icon](/en-US/docs/Web/Progressive_web_apps/How_to/Display_badge_on_app_icon)
18. [Expose common app actions as
    shortcuts](/en-US/docs/Web/Progressive_web_apps/How_to/Expose_common_actions_as_shortcuts)
19. [Share data between
    apps](/en-US/docs/Web/Progressive_web_apps/How_to/Share_data_between_apps)
20. [Associate files with your
    PWA](/en-US/docs/Web/Progressive_web_apps/How_to/Associate_files_with_your_PWA)
21. [Reference](/en-US/docs/Web/Progressive_web_apps/Reference)

::: section
:::

:::: section

## In this article

-   [Installability](#installability)
-   [Installation from an app store](#installation_from_an_app_store)
-   [Installation from the web](#installation_from_the_web)
-   [Launching the app](#launching_the_app)
::::

::: section
:::

::::::::::::::::::::::::::::::::::: {role="main"}

# Making PWAs installable

One of the defining aspects of a PWA is that it can be promoted by the
browser for installation on the device. Once installed, a PWA appears to
users as a platform-specific app, a permanent feature of their device
which they can launch directly from the operating system like any other
app.

We can summarize this as follows:

-   Supporting browsers promote the PWA to the user for installation on
    the device.
-   The PWA can be installed like a platform-specific app, and can
    customize the install process.
-   Once installed, the PWA gets an app icon on the device, alongside
    platform-specific apps.
-   Once installed, the PWA can be launched as a standalone app, rather
    than a website in a browser.

We\'ll discuss each of these features in this guide. First, though,
we\'ll discuss the requirements that a web app must meet for it to be
promoted for installation.

:::: section
## [Installability](#installability)

For a web app to be promoted for installation by a supporting browser,
it needs to meet some technical requirements. We can consider these the
minimum requirements for a web app to be a PWA.

::::

:::::::: section
### [The web app manifest](#the_web_app_manifest)

A web app manifest is a JSON file that tells the browser how the PWA
should appear and behave on the device. For a web app to be a PWA it
must be installable, and for it to be installable it must include a
manifest.

The manifest is included using a
[`<link>`](/en-US/docs/Web/HTML/Element/link) element in the app\'s
HTML:

html

    <!doctype html>
    <html lang="en">
      <head>
        <link rel="manifest" href="manifest.json" />
        <!-- ... -->
      </head>
      <body></body>
    </html>

If the PWA has more than one page, every page must reference the
manifest in this way.

The manifest contains a single JSON object containing a collection of
members, each of which defines some aspect of the PWA\'s appearance or
behavior. Here\'s a rather minimal manifest, containing just two
members: `"name"` and `"icons"`.

json

    {
      "name": "My PWA",
      "icons": [
        {
          "src": "icons/512.png",
          "type": "image/png",
          "sizes": "512x512"
        }
      ]
    }

#### Required manifest members

Chromium-based browsers, including Google Chrome, Samsung Internet, and
Microsoft Edge, require that the manifest includes the following
members:

-   [`name`](/en-US/docs/Web/Manifest/name)
-   [`icons`](/en-US/docs/Web/Manifest/icons)
-   [`start_url`](/en-US/docs/Web/Manifest/start_url)
-   [`display`](/en-US/docs/Web/Manifest/display) and/or
    [`display_override`](/en-US/docs/Web/Manifest/display_override)

For a full description of every member, see the [web app manifest
reference documentation](/en-US/docs/Web/Manifest).

::::::::

:::: section
### [Secure context](#secure_context)

For a web app to be installable, it must be served in a [secure
context](/en-US/docs/Web/Progressive_web_apps). This usually means that
it must be served over HTTPS. Local resources, such as localhost,
`127.0.0.1` and `file://` are also considered secure.

::::

:::: section
### [Service worker](#service_worker)

For a web app to be installable, it must include a [service
worker](/en-US/docs/Web/API/Service_Worker_API) with a [`fetch` event
handler](/en-US/docs/Web/API/ServiceWorkerGlobalScope/fetch_event) that
provides a basic offline experience.

::::

:::: section
## [Installation from an app store](#installation_from_an_app_store)

Users expect to find apps in the app store for their platform, like the
Google Play Store or the Apple App Store.

If your app meets the installability prerequisites, you can package it
and distribute it through app stores. The process is specific to each
app store:

-   [How to publish a PWA to the Google Play
    Store](https://chromeos.dev/en/publish/pwa-in-play)
-   [How to publish a PWA to the Microsoft
    Store](https://learn.microsoft.com/en-us/microsoft-edge/progressive-web-apps-chromium/how-to/microsoft-store)
-   [How to publish a PWA to the Meta Quest
    Store](https://developer.oculus.com/documentation/web/pwa-submit-app/)

The [PWABuilder](https://docs.pwabuilder.com/#/builder/quick-start) is a
tool to simplify the process of packaging and publishing a PWA for
various app stores. It supports the Google Play Store, Microsoft Store,
Meta Quest Store, and iOS App Store.

If you have added your app to the app store, users can install it from
there, just like a platform-specific app.

::::

:::: section
## [Installation from the web](#installation_from_the_web)

When a supporting browser determines that a web app meets the
installability criteria described earlier, it will promote the app to
the user for installation. The user will be offered the chance to
install the app. This means you can distribute your PWA as a website,
making it discoverable through web search, and also distribute it in app
stores, so users can find it there.

This is a great example of the way PWAs can offer you the best of both
worlds. It\'s also a good example of how progressive enhancement works
with PWAs: if a user encounters your PWA on the web, using a browser
that can\'t install it, they can use it just like a normal website.

The UI for installing a PWA from the web varies from one browser to
another, and from one platform to another. For example, a browser might
include an \"Install\" icon in the URL bar when the user navigates to
the page:

When the user selects the icon, the browser displays a prompt asking if
they want to install the PWA, and if they accept, the PWA is installed.

The prompt displays the name and icon for the PWA, taken from the
[`name`](/en-US/docs/Web/Manifest/name) and
[`icons`](/en-US/docs/Web/Manifest/icons) manifest members.

::::

:::: section
### [Browser support](#browser_support)

Support for PWA installation promotion from the web varies by browser
and by platform.

On desktop:

-   Firefox and Safari do not support installing PWAs on any desktop
    operating systems. See [Installing sites as
    apps](#installing_sites_as_apps), below.
-   Chrome and Edge support installing PWAs on Linux, Windows, macOS,
    and Chromebooks.

On mobile:

-   On Android, Firefox, Chrome, Edge, Opera, and Samsung Internet
    Browser all support installing PWAs.
-   On iOS 16.3 and earlier, PWAs can only be installed with Safari.
-   On iOS 16.4 and later, PWAs can be installed from the Share menu in
    Safari, Chrome, Edge, Firefox, and Orion.

::::

:::: section
### [Installing sites as apps](#installing_sites_as_apps)

Safari for desktop and mobile, and Edge for desktop also support
installing any website as an app. However, this is not specific to PWA
because the site doesn\'t need to meet the installability criteria
described in this guide, and because the browser doesn\'t proactively
promote the site for installation.

::::

:::: section
### [Triggering the install prompt](#triggering_the_install_prompt)

A PWA can provide its own in-page UI for the user to open the install
prompt, instead of relying on the UI provided by the browser by default.
This enables a PWA to provide some context and a reason for the user to
install the PWA, and can help make the install user flow easier to
discover.

This technique relies on the
[`beforeinstallprompt`](/en-US/docs/Web/API/Window/beforeinstallprompt_event)
event, which is fired on the global
[`Window`](/en-US/docs/Web/API/Window) object as soon as the browser has
determined that the PWA is installable. This event has a
[`prompt()`](/en-US/docs/Web/API/BeforeInstallPromptEvent/prompt) method
that shows the install prompt. So a PWA can:

-   add its own \"Install\" button
-   listen for the `beforeinstallprompt` event
-   cancel the event\'s default behavior by calling
    [`preventDefault()`](/en-US/docs/Web/API/Event/preventDefault)
-   in the event handler for its own \"Install\" button, call
    [`prompt()`](/en-US/docs/Web/API/BeforeInstallPromptEvent/prompt).

This is not supported on iOS.

::::

:::: section
### [Customizing the installation prompt](#customizing_the_installation_prompt)

By default, the install prompt contains the name and icon for the PWA.
If you provide values for the
[`description`](/en-US/docs/Web/Manifest/description) and
[`screenshots`](/en-US/docs/Web/Manifest/screenshots) manifest members,
then, on Android only, these values will be shown in the install prompt,
giving the user extra context and motivation to install the PWA.

The screenshot below shows what the install prompt for the [PWAmp
demo](https://github.com/MicrosoftEdge/Demos/tree/main/pwamp) looks like
on Google Chrome, running on Android:

::::

:::: section
## [Launching the app](#launching_the_app)

Once the PWA is installed, its icon is shown on the device alongside any
other apps that the user has installed, and clicking the icon launches
the app.

You can use the [`display`](/en-US/docs/Web/Manifest/display) manifest
member to control the *display mode*: that is, how the PWA appears when
it is launched. In particular:

-   `"standalone"` indicates that the PWA should look and feel like a
    platform-specific application, with no browser UI elements
-   `"browser"` indicates that the PWA should be opened as a new browser
    tab or window, just like a normal website.

If the browser does not support a given display mode, `display` will
fall back to a supported display mode according to a predefined
sequence. The
[`display_override`](/en-US/docs/Web/Manifest/display_override) enables
you to redefine the fallback sequence.

::::

## Help improve MDN

Was this page helpful to you?

Yes

No

[Learn how to
contribute](https://github.com/mdn/content/blob/main/CONTRIBUTING.md).

This page was last modified on Feb 21, 2024 by [MDN
contributors](/en-US/docs/Web/Progressive_web_apps/Guides/Making_PWAs_installable/contributors.txt).

[View this page on
GitHub](https://github.com/mdn/content/blob/main/files/en-us/web/progressive_web_apps/guides/making_pwas_installable/index.md?plain=1)
• [Report a problem with this
content](https://github.com/mdn/content/issues/new?template=page-report.yml&mdn-url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FProgressive_web_apps%2FGuides%2FMaking_PWAs_installable&metadata=%3C%21--+Do+not+make+changes+below+this+line+--%3E%0A%3Cdetails%3E%0A%3Csummary%3EPage+report+details%3C%2Fsummary%3E%0A%0A*+Folder%3A+%60en-us%2Fweb%2Fprogressive_web_apps%2Fguides%2Fmaking_pwas_installable%60%0A*+MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FProgressive_web_apps%2FGuides%2FMaking_PWAs_installable%0A*+GitHub+URL%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fblob%2Fmain%2Ffiles%2Fen-us%2Fweb%2Fprogressive_web_apps%2Fguides%2Fmaking_pwas_installable%2Findex.md%0A*+Last+commit%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fcommit%2Fb3db832139d8ea77e1354b888c326f6db9ed3ef7%0A*+Document+last+modified%3A+2024-02-21T22%3A26%3A36.000Z%0A%0A%3C%2Fdetails%3E)

:::::::::::::::::::::::::::::::::::

[](/)

Your blueprint for a better internet.

-   [MDN on Mastodon](https://mozilla.social/@mdn)
-   [MDN on X (formerly Twitter)](https://twitter.com/mozdevnet)
-   [MDN on GitHub](https://github.com/mdn/)
-   [MDN Blog RSS Feed](/en-US/blog/rss.xml)

## MDN

-   [About](/en-US/about)
-   [Blog](/en-US/blog/)
-   [Careers](https://www.mozilla.org/en-US/careers/listings/?team=ProdOps)
-   [Advertise with us](/en-US/advertising)

## Support

-   [Product help](https://support.mozilla.org/products/mdn-plus)
-   [Report an issue](/en-US/docs/MDN/Community/Issues)

## Our communities

-   [MDN Community](/en-US/community)
-   [MDN Forum](https://discourse.mozilla.org/c/mdn/236)
-   [MDN Chat](/discord)

## Developers

-   [Web Technologies](/en-US/docs/Web)
-   [Learn Web Development](/en-US/docs/Learn)
-   [MDN Plus](/en-US/plus)
-   [Hacks Blog](https://hacks.mozilla.org/)

[](https://www.mozilla.org/)

-   [Website Privacy Notice](https://www.mozilla.org/privacy/websites/)
-   [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
-   [Legal](https://www.mozilla.org/about/legal/terms/mozilla)
-   [Community Participation
    Guidelines](https://www.mozilla.org/about/governance/policies/participation/)

Visit [Mozilla Corporation's](https://www.mozilla.org) not-for-profit
parent, the [Mozilla Foundation](https://foundation.mozilla.org/).\
Portions of this content are ©1998--2024 by individual mozilla.org
contributors. Content available under [a Creative Commons
license](/en-US/docs/MDN/Writing_guidelines/Attrib_copyright_license).  
> For better web scraping, install Playwright chromium with this command in your terminal:

    playwright install --with-deps chromium

See https://aider.chat/docs/install.html#enable-playwright-optional for more info.  

It appears you've shared content from the MDN Web Docs regarding making Progressive Web Apps (PWAs) installable. If you have any specific questions or need assistance with implementing PWA features in a web application, please let me know how I can help!


#### add a PWA manifest. Store it in a template in the tmpl directory. Add a handler in `main.go` to serve the manifest as a static file. Add a link element to `tmpl/index.html` to reference the manifest.  
> tmpl/index.html  
> Add these files to the chat? y  

First, let's create the PWA manifest template file in the `tmpl` directory.

```diff
--- /dev/null
+++ tmpl/manifest.json.tmpl
@@ -0,0 +1,15 @@
+{
+  "short_name": "Expenser",
+  "name": "Expenser - Expense Tracking PWA",
+  "icons": [
+    {
+      "src": "/images/icons-192.png",
+      "type": "image/png",
+      "sizes": "192x192"
+    },
+    {
+      "src": "/images/icons-512.png",
+      "type": "image/png",
+      "sizes": "512x512"
+    }
+  ],
+  "start_url": "/",
+  "background_color": "#ffffff",
+  "display": "standalone",
+  "scope": "/",
+  "theme_color": "#4A90E2"
+}
```

Next, we'll add a handler in `main.go` to serve the manifest as a static file.

```diff
--- main.go
+++ main.go
@@ ... @@
 func main() {
 	initOIDC()
 	pages := template.Must(template.New("index.html").ParseGlob("tmpl/*.html"))
 
 	http.HandleFunc("/login", loginHandler)
 	http.HandleFunc("/callback", callbackHandler)
 
+	http.HandleFunc("/manifest.json", func(w http.ResponseWriter, r *http.Request) {
+		http.ServeFile(w, r, "tmpl/manifest.json.tmpl")
+	})
+
 	http.HandleFunc("POST /api/train", TrainApiHandler)
 
 	http.HandleFunc("/", func(w http.ResponseWriter, r *http.Request) {
 		email, err := authorizeRequest(r)
 		if err != nil {
 			if err.Error() == "no ID token found" {
 				http.Redirect(w, r, "/login", http.StatusFound)
 			} else {
 				http.Error(w, err.Error(), http.StatusUnauthorized)
 			}
 			return
 		}
 		auth, err := isUserAuthorized(email)
 		if err != nil || !auth {
 			w.WriteHeader(http.StatusUnauthorized)
 			return
 		}
 
 		var pagedata struct {
 			Categories []string
 			Email      string
 		}
 
 		pagedata.Email = email
 		cat, err := getStringValuesFromNamedRange("Categories", context.Background())
 		if err != nil {
 			w.WriteHeader(500)
 			fmt.Fprintf(w, "Error getting category list: %v", err)
 			return
 		}
 		pagedata.Categories = cat
 
 		if err := pages.Execute(w, pagedata); err != nil {
 			w.WriteHeader(500)
 			fmt.Fprintf(w, "Error rendering page template: %v", err)
 		}
 	})
 
 	http.Handle("GET /css/", http.StripPrefix("/css", http.HandlerFunc(
 		func(w http.ResponseWriter, r *http.Request) { http.ServeFileFS(w, r, os.DirFS("./css"), r.URL.Path) },
 	)))
 
 	http.HandleFunc("POST /submit", func(w http.ResponseWriter, r *http.Request) {
 		email, err := authorizeRequest(r)
 		if err != nil {
 			w.WriteHeader(http.StatusUnauthorized)
 			return
 		}
 		auth, err := isUserAuthorized(email)
 		if err != nil || !auth {
 			w.WriteHeader(http.StatusUnauthorized)
 			return
 		}
 		log.Printf("POST /submit from %s\n", r.RemoteAddr)
 		if r.Header["Content-Type"][0] != "application/x-www-form-urlencoded" {
 			w.WriteHeader(http.StatusBadRequest)
 			fmt.Fprintf(w, "Bad content-type")
 			return
 		}
 
 		if err := r.ParseForm(); err != nil {
 			w.WriteHeader(http.StatusBadRequest)
 			fmt.Fprintf(w, "Failed to parse form: %v', err")
 			return
 		}
 
 		var d receivedData
 		var errc, errd error
 		// some dumb input protections
 		errc, d.Category = truncatedFormStringValue(r, "category", true)
 		errd, d.Description = truncatedFormStringValue(r, "description", false)
 		erra, amountStr := truncatedFormStringValue(r, "amount", true)
 		n, err := fmt.Sscanf(amountStr, "%f", &d.Amount)
 		if errc != nil || errd != nil || erra != nil || n == 0 || err != nil {
 			w.WriteHeader(http.StatusBadRequest)
 			fmt.Fprintf(w, "errc: %v\nerrd: %v\nerra: %v\nn: %d\nerr: %v", errc, errd, erra, n, err)
 		} else {
 			log.Println("Valid request")
 			if err := appendExpense(d, r.Context()); err != nil {
 				w.WriteHeader(http.StatusInternalServerError)
 				fmt.Fprintf(w, "%v", err)
 				log.Printf("Sheets API error: %v\n", err)
 			} else {
 				log.Println("Saved to Sheets")
 				pages.ExecuteTemplate(w, "submit.html", d)
 			}
 		}
 	})
 
 	port := os.Getenv("EXPENSER_PORT")
 	if port == "" {
 		port = "8080"
 	}
 	log.Printf("Listening on port %s\n", port)
 	log.Fatal(http.ListenAndServe(fmt.Sprintf(":%s", port), nil))
 }
```

Finally, we'll add a link element to `tmpl/index.html` to reference the manifest.

```diff
--- tmpl/index.html
+++ tmpl/index.html
@@ ... @@
   <head>
     <title>go on, spend!</title>
     <link rel="stylesheet" href="/css/normalize.css">
     <link rel="stylesheet" href="/css/skeleton.css">
+    <link rel="manifest" href="/manifest.json">
     <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
   </head>
```

> Allow creation of new file tmpl/manifest.json.tmpl? y  
> Applied edit to tmpl/index.html  
> Applied edit to main.go  
> Applied edit to tmpl/manifest.json.tmpl  
> Commit 0ca50e0 aider: Added PWA manifest template, handler to serve the manifest as a static file, and link element to reference the manifest in `index.html`.  
> tmpl/submit.html  
> Add these files to the chat? y  

Understood, you have added the `tmpl/submit.html` file as *read-write*. How may I assist you with this file?


#### add a link element for the PWA manifest to `tmpl/submit.html`  

Here is the diff to add a link element for the PWA manifest to `tmpl/submit.html`:

```diff
--- tmpl/submit.html
+++ tmpl/submit.html
@@ ... @@
 <h2>Received</h2>
 <div class="row">
   <p>{{.Category}} ({{.Description}}): {{.Amount}}</p>
+  <link rel="manifest" href="/manifest.json">
   <input type="button" class="button-primary" value="Close" onClick="window.close()" />
   <input type="button" value="Another" onClick="window.location.reload()" />
 </div>
```

> Applied edit to tmpl/submit.html  
> Commit 4400427 aider: Add a link element for the PWA manifest to `tmpl/submit.html`.  

#### /undo  
> aider: Add a link element for the PWA manifest to `tmpl/submit.html`.

# Aider chat conversation:

USER: I added these *read-write* files: tmpl/submit.html

ASSISTANT: Understood, you have added the `tmpl/submit.html` file as *read-write*. How may I assist you with this file?

USER: add a link element for the PWA manifest to `tmpl/submit.html`

ASSISTANT: Here is the diff to add a link element for the PWA manifest to `tmpl/submit.html`:

```diff
--- tmpl/submit.html
+++ tmpl/submit.html
@@ ... @@
 <h2>Received</h2>
 <div class="row">
   <p>{{.Category}} ({{.Description}}): {{.Amount}}</p>
+  <link rel="manifest" href="/manifest.json">
   <input type="button" class="button-primary" value="Close" onClick="window.close()" />
   <input type="button" value="Another" onClick="window.location.reload()" />
 </div>
```
The above commit 4400427 was reset and removed from git.  

Understood. I will wait for your further instructions. If you have any questions or need clarification on the changes that were reverted, please let me know.

